# tmc-langs-node

Provides bindings to tmc-langs for Node.js. This project was bootstrapped by [create-neon](https://www.npmjs.com/package/create-neon).

## TypeScript definitions

You can find TypeScript files that can be used with the Node module in the `./ts` directory. `tmc.ts` is the main module which contains a `Tmc` class for using tmc-langs and re-exports the other modules. `generated.d.ts` contains type definitions for the relevant tmc-langs types like `ExercisePackagingConfiguration` and re-exported by `tmc.ts` as `langs`. `functions.d.ts` contains the types for the actual Node module and is wrapped by `tmc.ts`.

## Installing tmc-langs-node

Installing tmc-langs-node requires a [supported version of Node and Rust](https://github.com/neon-bindings/neon#platform-support).

You can install the project with npm. In the project directory, run:

```sh
$ npm install
```

This fully installs the project, including installing any dependencies and running the build.

## Building tmc-langs-node

If you have already installed the project and only want to run the build, run:

```sh
$ npm run build
```

This command uses the [cargo-cp-artifact](https://github.com/neon-bindings/cargo-cp-artifact) utility to run the Rust build and copy the built library into `./ts/functions.node`.

## Deployment

Node modules for the supported targets are built and deployed to Google Cloud when creating a GitHub release. The binaries are available at https://download.mooc.fi/tmc-langs-rust/, with each binary following the file name format `tmc-langs-{target}-{version}.node`. For a list of targets see the README at the repository root. For example, The 64-bit Linux binary for version 0.5.0 is available at https://download.mooc.fi/tmc-langs-rust/tmc-langs-x86_64-unknown-linux-gnu-0.5.0.node.

### Node module

The Node addon—i.e., a binary Node module—generated by building the project. This is the main module for this package, as dictated by the `"main"` key in `package.json`.

Under the hood, a [Node addon](https://nodejs.org/api/addons.html) is a [dynamically-linked shared object](https://en.wikipedia.org/wiki/Library_(computing)#Shared_libraries). The `"build"` script produces this file by copying it from within the `target/` directory, which is where the Rust build produces the shared object.
